
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title th:text="${pageTitle ?: '–í—ã–±–æ—Ä –∞–≤—Ç–æ–º–æ–±–∏–ª—è'} + ' - Antaliya Taxi Service'">–í—ã–±–æ—Ä –∞–≤—Ç–æ–º–æ–±–∏–ª—è - Antaliya Taxi Service</title>
  <style>
    /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –≤ —Ç–æ–º –∂–µ —Å—Ç–∏–ª–µ, —á—Ç–æ –∏ –∞–≤—Ç–æ–ø–∞—Ä–∫ */
    :root {
      --primary-color: #D4AF37; /* –ó–æ–ª–æ—Ç–æ–π */
      --primary-hover: #F2D571;
      --secondary-color: #121212; /* –ü–æ—á—Ç–∏ —á–µ—Ä–Ω—ã–π */
      --dark-color: #000000;
      --grey-color: #1E1E1E;
      --light-grey: #2A2A2A;
      --light-color: #F5F5F5;
      --white-color: #FFFFFF;
      --accent-color: #1E1E1E;
      --transition: all 0.3s cubic-bezier(0.165, 0.84, 0.44, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Raleway', sans-serif;
      color: var(--light-color);
      background-color: var(--dark-color);
      line-height: 1.6;
    }

    a {
      text-decoration: none;
      color: var(--primary-color);
      transition: var(--transition);
    }

    a:hover {
      color: var(--primary-hover);
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Montserrat', sans-serif;
      font-weight: 600;
      margin-bottom: 15px;
      color: var(--white-color);
    }

    p {
      margin-bottom: 15px;
    }

    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 50px 20px;
    }

    /* –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ */
    .breadcrumbs {
      display: flex;
      flex-wrap: wrap;
      margin-bottom: 30px;
      font-size: 14px;
      color: rgba(255, 255, 255, 0.6);
    }

    .breadcrumbs a {
      color: rgba(255, 255, 255, 0.6);
      margin-right: 10px;
      position: relative;
    }

    .breadcrumbs a:after {
      content: ">";
      margin-left: 10px;
      color: rgba(255, 255, 255, 0.3);
    }

    .breadcrumbs a:hover {
      color: var(--primary-color);
    }

    .breadcrumbs span {
      color: var(--primary-color);
    }

    /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—É—Ä–µ */
    .tour-info-banner {
      background-color: var(--secondary-color);
      border-radius: 8px;
      padding: 25px;
      margin-bottom: 30px;
      border-left: 4px solid var(--primary-color);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    .tour-info-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }

    .tour-info-header h2 {
      color: var(--white-color);
      margin-bottom: 10px;
      flex: 1;
    }

    .tour-price {
      font-size: 24px;
      font-weight: bold;
      color: var(--primary-color);
      margin-left: 20px;
    }

    .tour-meta {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      color: rgba(255, 255, 255, 0.7);
      font-size: 14px;
    }

    .tour-meta span {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      padding-bottom: 20px;
    }

    .page-header h1 {
      font-size: 32px;
      color: var(--white-color);
      position: relative;
    }

    .page-header h1::after {
      content: '';
      position: absolute;
      width: 50px;
      height: 3px;
      background-color: var(--primary-color);
      bottom: -10px;
      left: 0;
    }

    /* –§–∏–ª—å—Ç—Ä—ã */
    .filters-section {
      background-color: var(--secondary-color);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    .filters-header {
      color: var(--primary-color);
      margin-bottom: 20px;
      font-size: 18px;
    }

    .filters-form {
      display: grid;
      grid-template-columns: 1fr 1fr auto auto;
      gap: 15px;
      align-items: end;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
    }

    .filter-group label {
      margin-bottom: 8px;
      color: var(--white-color);
      font-weight: 500;
      font-size: 14px;
    }

    .form-control {
      padding: 12px 15px;
      border-radius: 6px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background-color: rgba(255, 255, 255, 0.05);
      color: var(--white-color);
      font-size: 16px;
      transition: var(--transition);
    }

    .form-control:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .btn-primary {
      background-color: var(--primary-color);
      color: var(--dark-color);
    }

    .btn-primary:hover {
      background-color: var(--primary-hover);
      transform: translateY(-2px);
    }

    .btn-secondary {
      background-color: rgba(255, 255, 255, 0.1);
      color: var(--white-color);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .btn-secondary:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }

    /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
    .stats-info {
      display: flex;
      align-items: center;
      font-size: 14px;
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 20px;
    }

    .stats-info span {
      margin-right: 20px;
      padding: 5px 10px;
      background-color: rgba(212, 175, 55, 0.1);
      border-radius: 4px;
      color: var(--primary-color);
    }

    /* –°–µ—Ç–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π */
    .vehicles-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 25px;
      margin-bottom: 40px;
    }

    .vehicle-card {
      background-color: var(--secondary-color);
      border-radius: 8px;
      overflow: hidden;
      transition: var(--transition);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      display: flex;
      flex-direction: column;
      position: relative;
      cursor: pointer;
    }

    .vehicle-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.25), 0 0 0 2px rgba(212, 175, 55, 0.3);
    }

    .vehicle-card.selected {
      border: 2px solid var(--primary-color);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.25), 0 0 0 2px var(--primary-color);
    }

    .vehicle-image-wrapper {
      position: relative;
      height: 200px;
      overflow: hidden;
    }

    .vehicle-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: var(--transition);
    }

    .vehicle-card:hover .vehicle-image {
      transform: scale(1.05);
    }

    /* –ë–µ–π–¥–∂–∏ */
    .status-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      background-color: rgba(40, 167, 69, 0.9);
      color: white;
    }

    .class-badge {
      position: absolute;
      top: 15px;
      left: 15px;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      background-color: rgba(212, 175, 55, 0.9);
      color: var(--dark-color);
    }

    .class-badge.premium {
      background-color: rgba(139, 92, 246, 0.9);
      color: white;
    }

    .recommended-badge {
      position: absolute;
      top: 50px;
      right: 15px;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      background-color: rgba(34, 197, 94, 0.9);
      color: white;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .vehicle-content {
      padding: 20px;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }

    .vehicle-title {
      font-size: 18px;
      margin-bottom: 15px;
      color: var(--white-color);
    }

    .vehicle-details {
      flex-grow: 1;
    }

    .vehicle-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 12px;
      font-size: 14px;
    }

    .vehicle-info span:first-child {
      color: rgba(255, 255, 255, 0.7);
    }

    .vehicle-info span:last-child {
      color: var(--white-color);
      font-weight: 500;
    }

    /* –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è */
    .vehicle-features-list {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 15px;
    }

    .feature-item {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      transition: var(--transition);
      background-color: rgba(255, 255, 255, 0.05);
      color: rgba(255, 255, 255, 0.6);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .feature-item.active {
      background-color: rgba(212, 175, 55, 0.15);
      color: var(--primary-color);
      border-color: rgba(212, 175, 55, 0.3);
    }

    .feature-item .feature-icon {
      font-size: 14px;
    }

    .feature-item .feature-text {
      font-weight: 500;
      white-space: nowrap;
    }

    .vehicle-price {
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .price-amount {
      font-weight: bold;
      color: var(--primary-color);
      font-size: 18px;
    }

    .price-multiplier {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.5);
    }

    .select-btn {
      background-color: var(--primary-color);
      color: var(--dark-color);
      padding: 8px 16px;
      border-radius: 6px;
      font-weight: 600;
      font-size: 14px;
      text-decoration: none;
      transition: var(--transition);
      border: none;
      cursor: pointer;
    }

    .select-btn:hover {
      background-color: var(--primary-hover);
      color: var(--dark-color);
      transform: translateY(-2px);
    }

    .select-btn.selected {
      background-color: var(--primary-color);
      color: var(--dark-color);
    }

    /* –ó–∞–≥—Ä—É–∑–∫–∞ */
    .loading {
      display: none;
      text-align: center;
      padding: 60px 20px;
      color: var(--primary-color);
    }

    .loading-spinner {
      font-size: 24px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π */
    .no-vehicles {
      text-align: center;
      padding: 60px 20px;
      color: rgba(255, 255, 255, 0.6);
    }

    .no-vehicles h3 {
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 20px;
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 991px) {
      .tour-info-header {
        flex-direction: column;
        align-items: flex-start;
      }

      .tour-price {
        margin-left: 0;
        margin-top: 10px;
      }

      .filters-form {
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }

      .vehicles-grid {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 20px;
      }
    }

    @media (max-width: 767px) {
      .container {
        padding: 30px 15px;
      }

      .filters-form {
        grid-template-columns: 1fr;
      }

      .vehicles-grid {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      }

      .page-header h1 {
        font-size: 28px;
      }

      .tour-meta {
        flex-direction: column;
        gap: 10px;
      }
    }

    @media (max-width: 480px) {
      .vehicles-grid {
        grid-template-columns: 1fr;
      }

      .page-header h1 {
        font-size: 24px;
      }
    }

  </style>
  <th:block th:replace="~{fragments/navbar :: navbar-styles}"></th:block>
</head>
<body>
<th:block th:replace="~{fragments/navbar :: navbar('booking')}"></th:block>

<div class="container">
  <!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
  <div class="breadcrumbs">
    <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
    <a href="/tours">–¢—É—Ä—ã</a>
    <span>–í—ã–±–æ—Ä –∞–≤—Ç–æ–º–æ–±–∏–ª—è</span>
  </div>

  <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—É—Ä–µ -->
  <div class="tour-info-banner" th:if="${tour}">
    <div class="tour-info-header">
      <h2 th:text="${tour.title}">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—É—Ä–∞</h2>
      <div class="tour-price" th:text="${tour.price ?: '–æ—Ç 80 ‚Ç¨'}">–æ—Ç 80 ‚Ç¨</div>
    </div>
    <div class="tour-meta">
      <span>üïê <span th:text="${tour.duration ?: '8 —á–∞—Å–æ–≤'}">8 —á–∞—Å–æ–≤</span></span>
      <span>üë• –î–æ <span th:text="${tour.maxParticipants}">8</span> —á–µ–ª–æ–≤–µ–∫</span>
      <span>üó£Ô∏è <span th:text="${tour.language ?: '–†—É—Å—Å–∫–∏–π –≥–∏–¥'}">–†—É—Å—Å–∫–∏–π –≥–∏–¥</span></span>
    </div>
  </div>

  <div class="page-header">
    <h1>–í—ã–±–µ—Ä–∏—Ç–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—å</h1>
  </div>

  <!-- –§–∏–ª—å—Ç—Ä—ã -->
  <div class="filters-section">
    <div class="filters-header">üîç –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–µ–∑–¥–∫–∏</div>
    <form id="filters-form" class="filters-form">
      <div class="filter-group">
        <label for="selectedDate">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Ç—É—Ä–∞</label>
        <input type="datetime-local" id="selectedDate" class="form-control"
               th:value="${#temporals.format(selectedDate, 'yyyy-MM-dd''T''HH:mm')}" required>
      </div>
      <div class="filter-group">
        <label for="passengers">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤</label>
        <input type="number" id="passengers" class="form-control"
               min="1" max="20" th:value="${passengers}" required>
      </div>
      <button type="submit" class="btn btn-primary">
        üîç –ù–∞–π—Ç–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏
      </button>
      <button type="button" class="btn btn-secondary" onclick="window.history.back()">
        ‚Üê –ù–∞–∑–∞–¥
      </button>
    </form>
  </div>

  <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
  <div class="stats-info">
    <span th:text="'–ù–∞–π–¥–µ–Ω–æ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π: ' + ${#lists.size(vehicles)}">–ù–∞–π–¥–µ–Ω–æ: 0</span>
    <span th:text="'–ù–∞ ' + ${#temporals.format(selectedDate, 'dd.MM.yyyy HH:mm')}">–ù–∞ 25.12.2024 14:00</span>
  </div>

  <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
  <div class="loading" id="loading">
    <div class="loading-spinner">‚è≥</div>
    <p>–ü–æ–∏—Å–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π...</p>
  </div>

  <!-- –°–µ—Ç–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π -->
  <div class="vehicles-grid" id="vehicles-container">
    <div th:each="vehicle : ${vehicles}" class="vehicle-card"
         th:onclick="'selectVehicle(' + ${vehicle.id} + ')'">
      <div class="vehicle-image-wrapper">
        <!-- –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–æ–±–∏–ª—è -->
        <div class="status-badge">–î–æ—Å—Ç—É–ø–µ–Ω</div>

        <!-- –ö–ª–∞—Å—Å –∞–≤—Ç–æ–º–æ–±–∏–ª—è -->
        <div class="class-badge"
             th:classappend="${vehicle.vehicleClass != null && vehicle.vehicleClass.premium} ? 'premium' : ''"
             th:text="${vehicle.vehicleClass?.displayName ?: '–°—Ç–∞–Ω–¥–∞—Ä—Ç'}">
          –ö–æ–º—Ñ–æ—Ä—Ç
        </div>

        <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è -->
        <div th:if="${vehicle.getModel()}" class="recommended-badge">
          –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º
        </div>

        <img class="vehicle-image"
             th:if="${vehicle.imageUrl != null && !vehicle.imageUrl.isEmpty()}"
             th:src="${vehicle.imageUrl}"
             th:alt="${vehicle.brand + ' ' + vehicle.model}">
        <img class="vehicle-image"
             th:unless="${vehicle.imageUrl != null && !vehicle.imageUrl.isEmpty()}"
             src="/images/default-vehicle.jpg"
             th:alt="${vehicle.brand + ' ' + vehicle.model}">
      </div>

      <div class="vehicle-content">
        <h3 class="vehicle-title">
          <span th:text="${vehicle.brand + ' ' + vehicle.model}">Mercedes Vito</span>
          <span th:if="${vehicle.year}" th:text="' (' + ${vehicle.year} + ')'"> (2023)</span>
        </h3>

        <div class="vehicle-details">
          <div class="vehicle-info">
            <span>–ü–∞—Å—Å–∞–∂–∏—Ä—ã:</span>
            <span th:text="${vehicle.passengerCapacity + ' —á–µ–ª.'}">6 —á–µ–ª.</span>
          </div>

          <div class="vehicle-info" th:if="${vehicle.luggageCapacity}">
            <span>–ë–∞–≥–∞–∂:</span>
            <span th:text="${vehicle.luggageCapacity + ' —á–µ–º–æ–¥–∞–Ω' + (vehicle.luggageCapacity == 1 ? '' : (vehicle.luggageCapacity < 5 ? '–∞' : '–æ–≤'))}">4 —á–µ–º–æ–¥–∞–Ω–∞</span>
          </div>

          <div class="vehicle-info" th:if="${vehicle.year}">
            <span>–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞:</span>
            <span th:text="${vehicle.year}">2023</span>
          </div>

          <!-- –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è -->
          <div class="vehicle-features-list">
            <div th:class="${vehicle.hasWifi != null and vehicle.hasWifi ? 'feature-item active' : 'feature-item'}">
              <span class="feature-icon">üì∂</span>
              <span class="feature-text">Wi-Fi</span>
            </div>

            <div th:class="${vehicle.hasAirConditioning != null and vehicle.hasAirConditioning ? 'feature-item active' : 'feature-item'}">
              <span class="feature-icon">‚ùÑÔ∏è</span>
              <span class="feature-text">–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä</span>
            </div>

            <div th:class="${vehicle.hasLeatherSeats != null and vehicle.hasLeatherSeats ? 'feature-item active' : 'feature-item'}">
              <span class="feature-icon">‚ú®</span>
              <span class="feature-text">–ö–æ–∂–∞</span>
            </div>

            <div th:class="${vehicle.hasChildSeat != null and vehicle.hasChildSeat ? 'feature-item active' : 'feature-item'}">
              <span class="feature-icon">üë∂</span>
              <span class="feature-text">–î–µ—Ç—Å–∫–∏–µ –∫—Ä–µ—Å–ª–∞</span>
            </div>
          </div>
        </div>

        <div class="vehicle-price">
          <div>
            <div class="price-amount" th:text="${vehicle.formattedPrice ?: '–æ—Ç 80 ‚Ç¨'}">–æ—Ç 80 ‚Ç¨</div>
            <div class="price-multiplier" th:if="${vehicle.vehicleClass?.priceMultiplier}"
                 th:text="'–ú–Ω–æ–∂–∏—Ç–µ–ª—å: x' + ${vehicle.vehicleClass.priceMultiplier}">
              –ú–Ω–æ–∂–∏—Ç–µ–ª—å: x1.3
            </div>
          </div>
          <button class="select-btn" th:onclick="'selectVehicle(' + ${vehicle.id} + ')'">
            ‚úì –í—ã–±—Ä–∞—Ç—å
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –Ω–µ—Ç -->
  <div th:if="${#lists.isEmpty(vehicles)}" class="no-vehicles">
    <h3>üöó –ê–≤—Ç–æ–º–æ–±–∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
    <p>–ù–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –¥–∞—Ç—É –∏–ª–∏ –≤—Ä–µ–º—è.</p>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('filters-form');
    const loading = document.getElementById('loading');
    const container = document.getElementById('vehicles-container');

    // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 1: –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ tourId
    let tourId;
    try {
      // –ü–æ–ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ Thymeleaf
      tourId = /*[[${tour.id}]]*/ null;

      // –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –ø–æ–ø—Ä–æ–±—É–µ–º –∏–∑ URL
      if (!tourId) {
        const pathParts = window.location.pathname.split('/');
        const tourIndex = pathParts.indexOf('tour');
        if (tourIndex !== -1 && pathParts[tourIndex + 1]) {
          tourId = parseInt(pathParts[tourIndex + 1]);
        }
      }

      // –ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –Ω–µ—Ç, –ø–æ–ø—Ä–æ–±—É–µ–º –∏–∑ data-–∞—Ç—Ä–∏–±—É—Ç–∞
      if (!tourId) {
        const tourElement = document.querySelector('[data-tour-id]');
        if (tourElement) {
          tourId = parseInt(tourElement.dataset.tourId);
        }
      }
    } catch (e) {
      console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è tourId:', e);
    }

    if (!tourId) {
      console.error('tourId –Ω–µ –Ω–∞–π–¥–µ–Ω!');
      alert('–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å ID —Ç—É—Ä–∞');
      return;
    }

    console.log('–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è tourId:', tourId);

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã
    const dateInput = document.getElementById('selectedDate');
    if (dateInput) {
      const tomorrow = new Date();
      tomorrow.setDate(tomorrow.getDate() + 1);
      dateInput.min = tomorrow.toISOString().slice(0, 16);
    }

    // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 2: –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤
    if (form) {
      form.addEventListener('submit', function(e) {
        e.preventDefault();

        const selectedDate = document.getElementById('selectedDate')?.value;
        const passengers = document.getElementById('passengers')?.value;

        // –í–∞–ª–∏–¥–∞—Ü–∏—è
        if (!selectedDate) {
          alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è');
          return;
        }

        if (!passengers || passengers < 1) {
          alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤');
          return;
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
        if (loading) loading.style.display = 'block';
        if (container) container.style.display = 'none';

        // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 3: –£–ª—É—á—à–µ–Ω–Ω—ã–π AJAX –∑–∞–ø—Ä–æ—Å —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
        const url = `/booking/tour/${tourId}/vehicles?date=${encodeURIComponent(selectedDate)}&passengers=${encodeURIComponent(passengers)}`;

        console.log('–ó–∞–ø—Ä–æ—Å –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π:', url);

        fetch(url, {
          method: 'GET',
          headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
          }
        })
                .then(response => {
                  console.log('–°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞:', response.status);

                  if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                  }

                  return response.json();
                })
                .then(vehicles => {
                  console.log('–ü–æ–ª—É—á–µ–Ω—ã –∞–≤—Ç–æ–º–æ–±–∏–ª–∏:', vehicles);
                  updateVehiclesList(vehicles, selectedDate, passengers);
                })
                .catch(error => {
                  console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π:', error);
                  alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π: ' + error.message);

                  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
                  if (container) {
                    container.innerHTML = `
                        <div class="no-vehicles" style="grid-column: 1/-1;">
                            <h3>‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h3>
                            <p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.</p>
                            <button onclick="location.reload()" class="select-btn">–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</button>
                        </div>
                    `;
                  }
                })
                .finally(() => {
                  if (loading) loading.style.display = 'none';
                  if (container) container.style.display = 'grid';
                });
      });
    }

    // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 4: –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
    window.selectVehicle = function(vehicleId) {
      console.log('–í—ã–±–æ—Ä –∞–≤—Ç–æ–º–æ–±–∏–ª—è:', vehicleId);

      if (!vehicleId) {
        console.error('vehicleId –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω!');
        alert('–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å ID –∞–≤—Ç–æ–º–æ–±–∏–ª—è');
        return;
      }

      if (!tourId) {
        console.error('tourId –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω!');
        alert('–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å ID —Ç—É—Ä–∞');
        return;
      }

      const selectedDate = document.getElementById('selectedDate')?.value;
      const passengers = document.getElementById('passengers')?.value;

      if (!selectedDate) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è');
        return;
      }

      // –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ URL —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
      const params = new URLSearchParams({
        date: selectedDate,
        passengers: passengers || '1'
      });

      const url = `/booking/tour/${tourId}/vehicle/${vehicleId}?${params.toString()}`;

      console.log('–ü–µ—Ä–µ—Ö–æ–¥ –ø–æ URL:', url);

      // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É
      const clickedButton = event?.target;
      if (clickedButton && clickedButton.classList.contains('select-btn')) {
        clickedButton.textContent = '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...';
        clickedButton.disabled = true;
      }

      // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
      window.location.href = url;
    };

    // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 5: –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
    function updateVehiclesList(vehicles, selectedDate, passengers) {
      if (!container) {
        console.error('–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –Ω–µ –Ω–∞–π–¥–µ–Ω');
        return;
      }

      console.log('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π:', vehicles?.length || 0);

      if (!vehicles || vehicles.length === 0) {
        container.innerHTML = `
                <div class="no-vehicles" style="grid-column: 1/-1;">
                    <h3>üöó –ê–≤—Ç–æ–º–æ–±–∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                    <p>–ù–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –¥–∞—Ç—É –∏–ª–∏ –≤—Ä–µ–º—è.</p>
                </div>
            `;
        return;
      }

      container.innerHTML = vehicles.map(vehicle => {
        // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª—è
        const vehicleId = vehicle.id;
        const brand = vehicle.brand || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
        const model = vehicle.model || '';
        const year = vehicle.year || '';
        const imageUrl = vehicle.imageUrl || '/images/default-vehicle.jpg';
        const passengerCapacity = vehicle.passengerCapacity || '?';
        const luggageCapacity = vehicle.luggageCapacity;
        const formattedPrice = vehicle.formattedPrice || '–¶–µ–Ω–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É';
        const vehicleClass = vehicle.vehicleClass || {};

        return `
                <div class="vehicle-card" data-vehicle-id="${vehicleId}">
                    <div class="vehicle-image-wrapper">
                        <div class="status-badge">–î–æ—Å—Ç—É–ø–µ–Ω</div>
                        <div class="class-badge ${vehicleClass.premium ? 'premium' : ''}">
                            ${vehicleClass.displayName || '–°—Ç–∞–Ω–¥–∞—Ä—Ç'}
                        </div>
                        ${vehicle.recommended ? '<div class="recommended-badge">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º</div>' : ''}
                        <img class="vehicle-image"
                             src="${imageUrl}"
                             alt="${brand} ${model}"
                             onerror="this.src='/images/default-vehicle.jpg'">
                    </div>
                    <div class="vehicle-content">
                        <h3 class="vehicle-title">
                            ${brand} ${model}${year ? ` (${year})` : ''}
                        </h3>
                        <div class="vehicle-details">
                            <div class="vehicle-info">
                                <span>–ü–∞—Å—Å–∞–∂–∏—Ä—ã:</span>
                                <span>${passengerCapacity} —á–µ–ª.</span>
                            </div>
                            ${luggageCapacity ? `
                            <div class="vehicle-info">
                                <span>–ë–∞–≥–∞–∂:</span>
                                <span>${luggageCapacity} —á–µ–º–æ–¥–∞–Ω${getLuggageEnding(luggageCapacity)}</span>
                            </div>
                            ` : ''}
                            ${year ? `
                            <div class="vehicle-info">
                                <span>–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞:</span>
                                <span>${year}</span>
                            </div>
                            ` : ''}
                        </div>
                        <div class="vehicle-price">
                            <div>
                                <div class="price-amount">${formattedPrice}</div>
                                ${vehicleClass.priceMultiplier ? `
                                <div class="price-multiplier">–ú–Ω–æ–∂–∏—Ç–µ–ª—å: x${vehicleClass.priceMultiplier}</div>
                                ` : ''}
                            </div>
                            <button class="select-btn" onclick="selectVehicle(${vehicleId}); return false;">
                                ‚úì –í—ã–±—Ä–∞—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
            `;
      }).join('');

      // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
      const statsElement = document.querySelector('.stats-info span:first-child');
      if (statsElement) {
        statsElement.textContent = `–ù–∞–π–¥–µ–Ω–æ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π: ${vehicles.length}`;
      }

      // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 6: –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
      addEventListenersToVehicleCards();
    }

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–∫–æ–Ω—á–∞–Ω–∏–π —Å–ª–æ–≤–∞ "—á–µ–º–æ–¥–∞–Ω"
    function getLuggageEnding(count) {
      if (count === 1) return '';
      if (count >= 2 && count <= 4) return '–∞';
      return '–æ–≤';
    }

    // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 7: –û—Ç–¥–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
    function addEventListenersToVehicleCards() {
      // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∏–∫ –ø–æ –≤—Å–µ–π –∫–∞—Ä—Ç–æ—á–∫–µ
      document.querySelectorAll('.vehicle-card').forEach(card => {
        card.addEventListener('click', function(e) {
          // –ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –Ω–µ –ø–æ –∫–Ω–æ–ø–∫–µ, –≤—ã–±–∏—Ä–∞–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª—å
          if (!e.target.classList.contains('select-btn')) {
            const vehicleId = this.dataset.vehicleId;
            if (vehicleId) {
              selectVehicle(parseInt(vehicleId));
            }
          }
        });

        // –≠—Ñ—Ñ–µ–∫—Ç—ã –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
        card.addEventListener('mouseenter', function() {
          this.style.borderColor = 'var(--primary-color, #007bff)';
          this.style.transform = 'translateY(-2px)';
        });

        card.addEventListener('mouseleave', function() {
          this.style.borderColor = 'transparent';
          this.style.transform = 'translateY(0)';
        });
      });
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
    addEventListenersToVehicleCards();

    // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 8: –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ (–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤–µ—Ä—Å–∏—è)
    function animateCards() {
      const cards = document.querySelectorAll('.vehicle-card');
      cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';

        setTimeout(() => {
          card.style.opacity = '1';
          card.style.transform = 'translateY(0)';
        }, index * 100);
      });
    }
    setTimeout(animateCards, 100);

    console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, tourId:', tourId);
  });
</script>

<th:block th:replace="~{fragments/navbar :: navbar-script}"></th:block>
</body>
</html>